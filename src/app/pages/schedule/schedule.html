<form nz-form class="filter">
  <div nz-row [nzGutter]="12" nzJustify="space-between" nzAlign="middle">
    
    <div nz-col nzFlex="1">
      <div nz-row [nzGutter]="12">
        <div nz-col nzFlex="1">
          <input nz-input placeholder="Tìm mã HP, tên HP, phòng..." 
            [(ngModel)]="searchInput" [ngModelOptions]="{standalone: true}">
        </div>
        <div nz-col>
          <button nz-button nzType="primary" type="button" (click)="onSearch()">Tìm kiếm</button>
        </div>
      </div>
    </div>
    <div nz-col>
      <button nz-button nzType="primary" type="button" (click)="showAddModal()">Thêm mới</button>
    </div>
  </div>
</form>

<nz-table [nzData]="filteredData" nzBordered>
  <thead>
    <tr>
      <th>Mã HP</th>
      <th>Tên HP</th>
      <th>Ngày</th>
      <th>Giờ</th>
      <th>Phút</th>
      <th>Phòng</th>
      <th>Số CB</th>
      <th>Hình thức thi</th>
      <th>Hành động</th>
    </tr>
  </thead>
  <tbody>
    @for (s of filteredData; track s.id) {
    <tr>
      <td>{{ s.courseCode }}</td>
      <td>{{ s.courseName }}</td>
      <td>{{ s.date }}</td>
      <td>{{ s.startTime }}</td>
      <td>{{ s.durationMin }}</td>
      <td>{{ s.roomName }}</td>
      <td>{{ s.proctorsNeeded }}</td>
      <td></td>
      <td>
        <nz-icon class="icon-action" nzType="edit" nzTheme="twotone" (click)="showEditModal(s)" />
        <nz-icon class.bind="icon-action" nzType="delete" nzTheme="twotone" (click)="deleteSchedule(s.id)" />
      </td>
    </tr>
    }
  </tbody>
</nz-table>

<nz-modal 
  [(nzVisible)]="isVisible" 
  [nzTitle]="isEditing ? 'Cập nhật lịch thi' : 'Thêm lịch thi mới'" 
  (nzOnCancel)="handleCancel()" 
  (nzOnOk)="handleOk()">

  <ng-container *nzModalContent>
    <form nz-form>
      <nz-form-item>
        <nz-form-label [nzSpan]="6">Mã HP</nz-form-label>
        <nz-form-control [nzSpan]="16">
          <input nz-input placeholder="Nhập mã học phần" 
            [(ngModel)]="scheduleForm.courseCode" [ngModelOptions]="{standalone: true}" />
        </nz-form-control>
      </nz-form-item>

      <nz-form-item>
        <nz-form-label [nzSpan]="6">Tên HP</nz-form-label>
        <nz-form-control [nzSpan]="16">
          <input nz-input placeholder="Nhập tên học phần" 
            [(ngModel)]="scheduleForm.courseName" [ngModelOptions]="{standalone: true}" />
        </nz-form-control>
      </nz-form-item>

      <nz-form-item>
        <nz-form-label [nzSpan]="6">Ngày</nz-form-label>
        <nz-form-control [nzSpan]="16">
          <input nz-input type="date" 
            [(ngModel)]="scheduleForm.date" [ngModelOptions]="{standalone: true}" />
        </nz-form-control>
      </nz-form-item>

      <nz-form-item>
        <nz-form-label [nzSpan]="6">Giờ</nz-form-label>
        <nz-form-control [nzSpan]="16">
          <input nz-input type="time" 
            [(ngModel)]="scheduleForm.startTime" [ngModelOptions]="{standalone: true}" />
        </nz-form-control>
      </nz-form-item>

      <nz-form-item>
        <nz-form-label [nzSpan]="6">Phút</nz-form-label>
        <nz-form-control [nzSpan]="16">
          <input nz-input type="number" placeholder="Nhập số phút" 
            [(ngModel)]="scheduleForm.durationMin" [ngModelOptions]="{standalone: true}" />
        </nz-form-control>
      </nz-form-item>

      <nz-form-item>
        <nz-form-label [nzSpan]="6">Phòng</nz-form-label>
        <nz-form-control [nzSpan]="16">
          <input nz-input placeholder="Nhập tên phòng" 
            [(ngModel)]="scheduleForm.roomName" [ngModelOptions]="{standalone: true}" />
        </nz-form-control>
      </nz-form-item>

      <nz-form-item>
        <nz-form-label [nzSpan]="6">Số CB</nz-form-label>
        <nz-form-control [nzSpan]="16">
          <input nz-input type="number" placeholder="Nhập số cán bộ" 
            [(ngModel)]="scheduleForm.proctorsNeeded" [ngModelOptions]="{standalone: true}" />
        </nz-form-control>
      </nz-form-item>
    </form>
  </ng-container> 
</nz-modal>